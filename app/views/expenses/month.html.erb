<h1>Expenses made in <%= Date::MONTHNAMES[Date.today.month] %></h1>

<br/>
<table>
	<tr>
		<th>Expense</th>
		<th>Amount</th>
		<th>Date</th> 
	</tr>
<% @expenses.each do |f| %>
	<tr>
		<td><%= f.expense_name %>
		</td>
		<td><%= f.amount %>
		</td>
        <td>
		<%= f.date.to_s(:short) %> 
		</td>
		
	</tr>
	<% end %>

</table>
<br/>
<p> Total expenditure this month : <%= Expense.where("date > ? AND date < ?", Time.now.beginning_of_month, Time.now.end_of_month).sum(:amount) %></p> <br/>

<%  date = 1.day.from_now(@expenses.first.date.to_date) rescue nil # increment the day
    @expenses.each do |item| 
      if date > item.date.to_date 
        date = item.date.to_date %>
        <div style="background: #81BEF7;margin-top: 5px; margin-bottom: 5px;" class="rounded"><b><span style="padding: 5px"><%=h date %></span></b></div>
      <%end%>

      <p>

      <span class="subtext" style="margin-left: 55px">by <%=h Expense.where("date = ?",date) %></span>
    </p>

<%  end # end for items_each%>